# This is a basic workflow to help you get started with Actions

name: CI

# Controls when the workflow will run
on:
  workflow_dispatch:

      #- run: dotnet nuget push ./nupkg/*.nupkg --api-key ${{ secrets.NUGET_API_KEY }} --source https://api.nuget.org/v3/index.json --skip-duplicate
# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  publish:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        project:
          - Asgard/SystemModules/Asgard.Hoenir/Asgard.Hoenir.csproj          
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '8.x'
      - run: dotnet restore Asgard/Asgard.sln
      - run: dotnet build ${{ matrix.project }} --configuration Release --no-restore
      - run: dotnet pack ${{ matrix.project }} --configuration Release --no-build --output ./nupkg
      - name: üß™ Test Output - List Generated .nupkg Files
        run: |
          echo "üì¶ Generated NuGet packages:"
          ls -l ./nupkg/
          echo ""
          echo "‚úÖ Would push the following packages (dry run):"
          for pkg in ./nupkg/*.nupkg; do
            if [ -f "$pkg" ]; then
              echo "  ‚û§ $pkg"
            else
              echo "  ‚ùå No .nupkg files found!"
              exit 1
            fi
          done
